{"remainingRequest":"D:\\code\\vue-软件工程课程设计\\bookstore\\node_modules\\_vue-loader@15.9.3@vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\vue-软件工程课程设计\\bookstore\\src\\views\\Books.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\vue-软件工程课程设计\\bookstore\\src\\views\\Books.vue","mtime":1598091653007},{"path":"D:\\code\\vue-软件工程课程设计\\bookstore\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\code\\vue-软件工程课程设计\\bookstore\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\code\\vue-软件工程课程设计\\bookstore\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\code\\vue-软件工程课程设计\\bookstore\\node_modules\\_vue-loader@15.9.3@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBCb29rTGlzdCBmcm9tICJAL2NvbXBvbmVudHMvQm9va0xpc3QiCmltcG9ydCBMb2FkaW5nIGZyb20gJ0AvY29tcG9uZW50cy9Mb2FkaW5nLnZ1ZScKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6J0Jvb2tzJywKICBwcm9wczpbJyddLAogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgdGl0bGU6ICcnLAogICAgICBib29rczogW10sCiAgICAgIG1lc3NhZ2U6ICcnLAogICAgICBsb2FkaW5nOiB0cnVlLAogICAgICB0b3RhbDogNSwKICAgICAgcGFnZU51bTogMSwKICAgICAgcGFnZVNpemU6IDIKICAgIH07CiAgfSwKCiAgYmVmb3JlUm91dGVFbnRlcih0bywgZnJvbSwgbmV4dCl7CiAgICBuZXh0KHZtID0+IHsKICAgICAgdm0udGl0bGUgPSB0by5tZXRhLnRpdGxlOwogICAgICBsZXQgdXJsID0gdm0uc2V0UmVxdWVzdFVybCh0by5mdWxsUGF0aCk7CiAgICAgIHZtLmdldEJvb2tzKHVybCwgdm0ucGFnZU51bSwgdm0ucGFnZVNpemUpOwogICAgfSk7CiAgfSwKICBiZWZvcmVSb3V0ZVVwZGF0ZSh0bywgZnJvbSwgbmV4dCl7CiAgICBsZXQgdXJsID0gdGhpcy5zZXRSZXF1ZXN0VXJsKHRvLmZ1bGxQYXRoKTsKICAgIHRoaXMuZ2V0Qm9va3ModXJsLCB0aGlzLnBhZ2VOdW0sIHRoaXMucGFnZVNpemUpOwogICAgbmV4dCgpOwogIH0sCgogIGNvbXBvbmVudHM6IHsKICAgIEJvb2tMaXN0LAogICAgTG9hZGluZwogIH0sCgogIG1ldGhvZHM6IHsKICAgIGdldEJvb2tzKHVybCwgcGFnZU51bSwgcGFnZVNpemUpewogICAgICB0aGlzLm1lc3NhZ2UgPSAnJzsKICAgICAgdGhpcy5heGlvcy5nZXQodXJsLCB7cGFyYW1zOiB7cGFnZU51bSwgcGFnZVNpemV9fSkKICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICBpZihyZXNwb25zZS5kYXRhLmNvZGUgPT0gMjAwKXsKICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMuYm9va3MgPSByZXNwb25zZS5kYXRhLmRhdGE7CiAgICAgICAgICAgIHRoaXMudG90YWwgPSByZXNwb25zZS5kYXRhLnRvdGFsOwogICAgICAgICAgICBpZih0aGlzLmJvb2tzLmxlbmd0aCA9PT0gMCl7CiAgICAgICAgICAgICAgaWYodGhpcy4kcm91dGUubmFtZSA9PT0gImNhdGVnb3J5IikKICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZSA9ICLlvZPliY3liIbnsbvkuIvmsqHmnInlm77kuabvvIEiCiAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gIuayoeacieaQnOe0ouWIsOWMuemFjeeahOWbvuS5pu+8gSIKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGVycm9yID0+IGFsZXJ0KGVycm9yKSk7CiAgICB9LAogICAgLy8g5Yqo5oCB6K6+572u5pyN5Yqh56uv5pWw5o2u5o6l5Y+j55qE6K+35rGCVVJMCiAgICBzZXRSZXF1ZXN0VXJsKHBhdGgpewogICAgICBsZXQgdXJsID0gcGF0aDsKICAgICAgaWYocGF0aC5pbmRleE9mKCIvY2F0ZWdvcnkiKSAhPSAtMSl7CiAgICAgICAgdXJsID0gIi9ib29rIiArIHVybCArICIvcGFnZSI7CiAgICAgIH0KICAgICAgcmV0dXJuIHVybDsKICAgIH0sCiAgICBoYW5kbGVTaXplQ2hhbmdlKHNlbGVjdGVkU2l6ZSkgewogICAgICAgICAgdGhpcy5wYWdlU2l6ZSA9IHNlbGVjdGVkU2l6ZTsKICAgICAgICAgIC8vY29uc29sZS5sb2codGhpcy5wYWdlU2l6ZSkgLy/mr4/pobXkuIvmi4nmmL7npLrmlbDmja7mnaHmlbAKICAgICAgICAgIGxldCB1cmwgPSB0aGlzLnNldFJlcXVlc3RVcmwodGhpcy4kcm91dGUuZnVsbFBhdGgpOwogICAgICAgICAgdGhpcy5nZXRCb29rcyh1cmwsIHRoaXMucGFnZU51bSwgdGhpcy5wYWdlU2l6ZSk7CiAgICAgIH0sCgogICAgaGFuZGxlQ3VycmVudENoYW5nZShjdXJyZW50UGFnZSkgewogICAgICAgIHRoaXMucGFnZU51bSA9IGN1cnJlbnRQYWdlCiAgICAgICAgbGV0IHVybCA9IHRoaXMuc2V0UmVxdWVzdFVybCh0aGlzLiRyb3V0ZS5mdWxsUGF0aCk7CiAgICAgICAgLy8gY29uc29sZS5sb2coY3VycmVudFBhZ2UpIC8v54K55Ye756ys5Yeg6aG1CiAgICAgICAgdGhpcy5nZXRCb29rcyh1cmwsIHRoaXMucGFnZU51bSwgdGhpcy5wYWdlU2l6ZSkKICAgIH0sCiAgfQp9Cg=="},{"version":3,"sources":["Books.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAoBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Books.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div>\r\n    <Loading v-if=\"loading\" />\r\n    <h3 v-else>{{ title }}</h3>\r\n    <BookList :list = \"books\"/>\r\n    <h1>{{ message }}</h1>\r\n    <el-pagination \r\n      :hide-on-single-page=\"true\"\r\n      @size-change=\"handleSizeChange\" \r\n      :page-sizes=\"[2, 3, 10, 20]\" \r\n      @current-change=\"handleCurrentChange\" \r\n      :current-page=\"pageNum\" \r\n      :page-size=\"pageSize\"\r\n      layout=\"total, sizes, prev, pager, next, jumper\" \r\n      :total=\"total\">\r\n    </el-pagination>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import BookList from \"@/components/BookList\"\r\n  import Loading from '@/components/Loading.vue'\r\n  export default {\r\n    name:'Books',\r\n    props:[''],\r\n    data () {\r\n      return {\r\n        title: '',\r\n        books: [],\r\n        message: '',\r\n        loading: true,\r\n        total: 5,\r\n        pageNum: 1,\r\n        pageSize: 2\r\n      };\r\n    },\r\n\r\n    beforeRouteEnter(to, from, next){\r\n      next(vm => {\r\n        vm.title = to.meta.title;\r\n        let url = vm.setRequestUrl(to.fullPath);\r\n        vm.getBooks(url, vm.pageNum, vm.pageSize);\r\n      });\r\n    },\r\n    beforeRouteUpdate(to, from, next){\r\n      let url = this.setRequestUrl(to.fullPath);\r\n      this.getBooks(url, this.pageNum, this.pageSize);\r\n      next();\r\n    },\r\n\r\n    components: {\r\n      BookList,\r\n      Loading\r\n    },\r\n\r\n    methods: {\r\n      getBooks(url, pageNum, pageSize){\r\n        this.message = '';\r\n        this.axios.get(url, {params: {pageNum, pageSize}})\r\n          .then(response => {\r\n            if(response.data.code == 200){\r\n              this.loading = false;\r\n              this.books = response.data.data;\r\n              this.total = response.data.total;\r\n              if(this.books.length === 0){\r\n                if(this.$route.name === \"category\")\r\n                  this.message = \"当前分类下没有图书！\"\r\n                else\r\n                  this.message = \"没有搜索到匹配的图书！\"\r\n              }\r\n            }\r\n          })\r\n          .catch(error => alert(error));\r\n      },\r\n      // 动态设置服务端数据接口的请求URL\r\n      setRequestUrl(path){\r\n        let url = path;\r\n        if(path.indexOf(\"/category\") != -1){\r\n          url = \"/book\" + url + \"/page\";\r\n        }\r\n        return url;\r\n      },\r\n      handleSizeChange(selectedSize) {\r\n            this.pageSize = selectedSize;\r\n            //console.log(this.pageSize) //每页下拉显示数据条数\r\n            let url = this.setRequestUrl(this.$route.fullPath);\r\n            this.getBooks(url, this.pageNum, this.pageSize);\r\n        },\r\n\r\n      handleCurrentChange(currentPage) {\r\n          this.pageNum = currentPage\r\n          let url = this.setRequestUrl(this.$route.fullPath);\r\n          // console.log(currentPage) //点击第几页\r\n          this.getBooks(url, this.pageNum, this.pageSize)\r\n      },\r\n    }\r\n  }\r\n</script>\r\n<style scoped>\r\n\r\n</style>"]}]}